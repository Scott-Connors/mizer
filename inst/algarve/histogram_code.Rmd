---
title: "R Notebook"
output: html_notebook
---

## A title
Some explanation of what you are doing. Then some code in an R code block.
We should use file paths relative to the directory this notebook is in.
```{r}
params <- readRDS("params_36.rds")
```
Now that we have the params object we can just get the bins from there
```{r}
bins <- params@w
```
Let's load the data
```{r}
library(readr)
fish_sizes_sp <- read_csv("fish_sizes_sp.csv", skip = 1)
```

Now we can make plots. This too needs to go into an R code block.
```{r}
y <- c(0.8, 2500)
hist(fish_sizes_sp$Dourada, breaks = bins, xlim = y)
hist(fish_sizes_sp$Choupa, breaks = bins, xlim = y)
hist(fish_sizes_sp$baila, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$toadfish, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$Eel, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$Pargo, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$garfish, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$Seabass, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$sole, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$Mucharra, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$Safia, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$silverside, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`red mullet`, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`Sargo`, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`Salema`, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`wrasse`, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`goby`, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`anchovy`, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`sardine`, breaks = bins, xlim = y, freq = TRUE)
hist(fish_sizes_sp$`grey mullet`, breaks = bins, xlim = y, freq = TRUE)
```
```{r}

```

We can also use ggplot2 package for plots.
```{r}
library(ggplot2)
library(plotly)
```
It works with long dataframes. The reshape2 package has a nice command for
converting short data frames into long ones.
```{r}
library(reshape2)
df <- melt(fish_sizes_sp, na.rm = TRUE)
```
Let's look at the first few entries
```{r}
head(df)
```
Now we can plot
```{r}
ggplot(df[df$variable != "sardine",], aes(value)) + geom_histogram(breaks = bins) +
  coord_trans(x = "log10") +
    facet_wrap(vars(variable))
```
```{r}
ggplot(df[df$variable == "Choupa",], aes(value)) + geom_histogram(breaks = bins) +
  coord_trans(x = "log10") 
```
```{r}
plotSpectra(params, plankton = FALSE, total = TRUE, power = 0)
```
Using base plot again.
```{r}
plot(params@w, params@initial_n["Choupa",], type="l", log="xy")
```
Calculate the number density from the observational data. This means we need to count the number of individuals in each size bracket and then divide that vector by the vector params@dw which holds the widths of the size brackets. Then we can plot that vector on top of the above plot.
```{r}

```



