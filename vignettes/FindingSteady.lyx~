#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
On Finding Steady States In Size Spectrum Models
\end_layout

\begin_layout Author
Richard Southwell
\end_layout

\begin_layout Section
Getting a steady state by evolving with fixed egg production
\end_layout

\begin_layout Standard
This is my interpretation of the steady state finding procedure conceived
 of by Gustav Delius.
\end_layout

\begin_layout Standard
We shall describe how to find a steady state of a given a multi-species
 size spectrum model, of the type described in Section 3 of [
\begin_inset CommandInset href
LatexCommand href
name "mizer vignette"
target "https://cran.r-project.org/web/packages/mizer/vignettes/mizer_vignette.pdf"

\end_inset

].
 We assume all parameters are pre-determined, although our procedure involves
 retuning the reproduction efficiency 
\begin_inset Formula $\epsilon_{i}.$
\end_inset

 
\end_layout

\begin_layout Subsection*
Step 1: Pick Initial Condition
\end_layout

\begin_layout Standard
Suppose we wish to construct the coexistent steady state 
\begin_inset Formula $(N_{R},N)$
\end_inset

 that maximizes some objective function 
\begin_inset Formula $\Psi((N_{R},N)).$
\end_inset

 For example 
\begin_inset Formula $\Psi$
\end_inset

 could encode how well the biomass values for the different species in 
\begin_inset Formula $(N_{R},N)$
\end_inset

 agree with empirical data.
 Our initial condition 
\begin_inset Formula $(N'_{R},N')$
\end_inset

 may be chosen by any criterion.
 For example, one may wish to choose the initial condition 
\begin_inset Formula $(N'_{R},N')$
\end_inset

 that maximizes 
\begin_inset Formula $\Psi$
\end_inset

 over all states.
\end_layout

\begin_layout Subsection*
Step 2: Set Initial Egg Production
\end_layout

\begin_layout Standard
We need to choose a value 
\begin_inset Formula $R_{i}$
\end_inset

 at which to fix the egg production, of each species 
\begin_inset Formula $i$
\end_inset

 in 
\begin_inset Formula $\left\{ 1,2,..,s\right\} .$
\end_inset

 For example, we could choose 
\end_layout

\begin_layout Standard
\begin_inset Formula $R_{i}=\frac{R_{max.i}R_{p.i}}{R_{max.i}+R_{p.i}}$
\end_inset


\end_layout

\begin_layout Standard
where 
\end_layout

\begin_layout Standard
\begin_inset Formula $R_{p.i}=\frac{\epsilon}{2w_{0}}\int_{0}^{\infty}N'_{i}(w)E_{r.i}(w)\psi_{i}(w).dw$
\end_inset


\end_layout

\begin_layout Standard
is the egg production that would be generated by state 
\begin_inset Formula $(N'_{R},N')$
\end_inset

 (before adjusting for the stock recruitment relationship).
 
\end_layout

\begin_layout Subsection*
Step 3: Evolve System With Egg Production Held Fixed
\end_layout

\begin_layout Standard
We evolve the system under the Mckendrick von Foerster equation (and using
 the semi-chemostat equation for the resource dynamics), as described in
 Section 3 of [
\begin_inset CommandInset href
LatexCommand href
name "mizer vignette"
target "https://cran.r-project.org/web/packages/mizer/vignettes/mizer_vignette.pdf"

\end_inset

], except that we held the egg production fixed at 
\begin_inset Formula $N_{i}(t,w_{0.i})=R_{i}$
\end_inset

 for each time 
\begin_inset Formula $t.$
\end_inset

 Although it is unclear, experiments suggest that in these kinds of systems,
 where the egg production values are held fixed at 
\begin_inset Formula $R_{i},$
\end_inset

 have just one coexistent steady state (that is, a steady state where each
 species has none zero density).
 In most cases these dynamics will evolve to a steady state 
\begin_inset Formula $(N_{R}^{*},N^{*}).$
\end_inset

 And although we have observed cases where such dynamics do not settle to
 a steady state (and instead end in an oscillation), hopefully a unique
 coexistent steady state 
\begin_inset Formula $(N_{R}^{*},N^{*})$
\end_inset

 can still be found in such cases, using Netwton-Raphson.
 [Questions: does the final state/limit cycle depend on the initial condition
 ? In cases which cycles when egg reproduction is held fixed, what happens
 if egg production is then allowed to vary naturally, Do systems which are
 oscillatory when egg production is held fixed remain so, when egg production
 is properly generated in a density dependent manner.]
\end_layout

\begin_layout Subsection*
Step 4: Optimize (optional)
\end_layout

\begin_layout Standard
Compute 
\begin_inset Formula $\Psi((N_{R}^{*},N^{*}))$
\end_inset

 for the resulting steady state.
 If desired one may keep re-selecting the egg production values 
\begin_inset Formula $(R_{1},..,R_{s})$
\end_inset

 and re-running Step 3 (hopefully the dynamics are such that the initial
 condition is irrelevant, but we should check), in order to get a new steady
 state,..
 etc.
 So essentially one could attempt to select 
\begin_inset Formula $(R_{1},..,R_{s})$
\end_inset

 to optimize 
\begin_inset Formula $\Psi((N_{R}^{*},N^{*}))$
\end_inset

, with the caveat that we may not be able to find a steady state for some
 values of 
\begin_inset Formula $(R_{1},..,R_{s})$
\end_inset

 by simply evolving the system (although hopefully there is still a unique
 coexistant steady state to find using Netwon-Raphson).
 
\end_layout

\begin_layout Subsection*
Step 5: Re-select reproduction efficiency
\end_layout

\begin_layout Standard
We take the steady state 
\begin_inset Formula $(N_{R}^{*},N^{*})$
\end_inset

 from the constant-egg-production system, and, for each species 
\begin_inset Formula $i$
\end_inset

 in 
\begin_inset Formula $\left\{ 1,..,s\right\} ,$
\end_inset

 choose a new value 
\begin_inset Formula $\epsilon'_{i}$
\end_inset

 of the reproduction efficiency, so that the value 
\begin_inset Formula $R_{i}$
\end_inset

 at which the egg production was previously held constant, is equal to the
 amount of eggs 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{R_{max.i}\times\frac{\epsilon'_{i}}{2w_{0.i}}\int_{0}^{\infty}N{}_{i}^{*}(w)E_{r.i}(w)\psi_{i}(w).dw}{R_{max.i}+\frac{\epsilon'_{i}}{2w_{0.i}}\int_{0}^{\infty}N{}_{i}^{*}(w)E_{r.i}(w)\psi_{i}(w).dw}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
that would be generated by the resulting steady state, using the new reproductio
n efficiency value 
\begin_inset Formula $\epsilon'_{i}$
\end_inset

 (and accounting from possible egg loss due to 
\begin_inset Formula $R_{max}$
\end_inset

).
 
\end_layout

\begin_layout Subsection*
Result
\end_layout

\begin_layout Standard
\begin_inset Formula $(N_{R}^{*},N^{*})$
\end_inset

 will be a steady state of the resulting multi-species size spectrum model,
 using new reproduction efficiency values 
\begin_inset Formula $\epsilon'_{i}.$
\end_inset

 The steady state construction procedure described above can be repeated
 for different parameter choices until one is satisfied with the resulting
 reproduction efficiency values.
 Alternatively, the objective function 
\begin_inset Formula $\Psi$
\end_inset

 referred to in step 4 could be selected so as to reward the generation
 of the proper reproduction efficiency value as the output 
\begin_inset Formula $\epsilon'_{i}$
\end_inset

.
 
\end_layout

\begin_layout Subsection*
Remaining Questions
\end_layout

\begin_layout Itemize
When does the algorithm fail ?
\end_layout

\begin_layout Itemize
Do basins of attraction matter ?
\end_layout

\begin_layout Itemize
Is there always one unique interior steady state ? 
\end_layout

\begin_layout Itemize
What are the partial functions like: from 
\begin_inset Formula $(R_{1},..,R_{s})$
\end_inset

 to 
\begin_inset Formula $(N_{R}^{*},N^{*}),$
\end_inset

 and from 
\begin_inset Formula $(N_{R}^{*},N^{*})$
\end_inset

 to 
\begin_inset Formula $(\epsilon_{1},..,\epsilon_{s})$
\end_inset

 ? 
\end_layout

\begin_layout Section
Newton-Raphson
\end_layout

\begin_layout Standard
Need to descibe discretization scheme, and function to find zero of, for
 Newton-Raphson solving.
\end_layout

\begin_layout Section
Ideas
\end_layout

\begin_layout Standard
Can we do larger scale experiments about finding steady states of systems
 with more species, and see how algos perform
\end_layout

\begin_layout Section
Homogenous case
\end_layout

\begin_layout Standard
Faster way to find steady state in the case where all species have the same
 feeding kernel.
 In this case, the growth and death rate of each species just depeds upon
 the total abundance, aggregated over all species.
 
\end_layout

\end_body
\end_document
